### VMware Windows Server Template Automation Process - 20230424 ###

Working on TPLT-Win2019_vD202303ns...
Creating Backup Template of TPLT-Win2019_vD202303ns using New-Template...
Converting TPLT-Win2019_vD202303ns to VM using Set-Template and invoking stopwatch for 60 seconds...
Powering on TPLT-Win2019_vD202303ns using Start-VM, Get-VMQuestions, Set-VMQuestion, and invoking stopwatch for 120 seconds...
Importing PSWindowsUpdate Module on TPLT-Win2019_vD202303ns using Invoke-VMScript and invoking stopwatch for 10 seconds...
Executing Windows Updates via PowerShell with Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -NotTitle 'Windows Malicious Software Removal Tool*' -AutoReboot on TPLT-Win2019_vD202303ns using Invoke-VMScript and invoking stopwatch for 60 seconds...
Restarting TPLT-Win2019_vD202303ns using Restart-VMGuest and sleeping for 45 minutes (2700s) while updates complete...
Checking for additional Windows Updates on TPLT-Win2019_vD202303ns using Invoke-VMScript and invoking stopwatch for 60 seconds...
Restarting TPLT-Win2019_vD202303ns using Restart-VMGuest and sleeping for 15 minutes (900s) in case there are updates to complete...
Updating VMware Tools on TPLT-Win2019_vD202303ns using Update-Tools...
Shutting down TPLT-Win2019_vD202303ns using Shutdown-VMGuest and invoking stopwatch for 180 seconds...
Converting TPLT-Win2019_vD202303ns back to a Template and updating its name using Set-VM...
Finished Processing TPLT-Win2019_vD202303ns...



Cloning Template TPLT-Win2019_vD202304ns for Sysprep process using New-Template...
Converting Template TPLT-Win2019_vD202304s to VM using Set-Template...
Powering on TPLT-Win2019_vD202304s using Start-VM and invoking stopwatch for 120 seconds...
Executing Sysprep PowerShell Script on TPLT-Win2019_vD202304s using Invoke-VMScript...
Verifying VM TPLT-Win2019_vD202304s is Powered Off...
Converting Syspreped VM to Template  Set-VM...
Finished Processing TPLT-Win2019_vD202304s for Sysprep...



Deploying a Test VM ritwin19tstd01 using Template TPLT-Win2019_vD202304s using New-VM...
Powering on ritwin19tstd01 using Start-VM and invoking stopwatch for 120 seconds...
Waiting 15 minutes (900s) for ritwin19tstd01 to complete building...
Checking Post Deployment Results on TPLT-Win2019_vD202304s using Invoke-VMScript and storing results in variable...
Shutting down ritwin19tstd01 using Shutdown-VMGuest and invoking stopwatch for 120 seconds...
Removing ritwin19tstd01 from vCenter permanently using Remove-VM...
Removing TPLT-Win2019_vD202303ns_bkp from vCenter permanently using Remove-Template...
Removing ritwin19tstd01 AD Object from AD using Remove-ADComputer...
Cloning Template TPLT-Win2019_vD202304s for publishing process using New-Template...
Gathering TPLT-Win2019_vP202304s Template ID *** STACKSTORM Integration ONLY *** ...
Objectifying Template Data From TPLT-Win2019_vP202304s *** STACKSTORM Integration ONLY *** ...
Gathering StackStorm Dev Key for TPLT-Win2019_vP202304s *** STACKSTORM Integration ONLY *** ...
Setting new template key value for TPLT-Win2019_vP202304s for StackStorm Dev *** STACKSTORM Integration ONLY *** ...
Gathering StackStorm Prod Key for TPLT-Win2019_vP202304s *** STACKSTORM Integration ONLY *** ...
Setting new template key value for TPLT-Win2019_vP202304s for StackStorm Prod *** STACKSTORM Integration ONLY *** ...
Moving TPLT-Win2019_vP202303s to Previous Release Folder using Move-Template and Set-Template...
Removing Previous Prod Template from Previous Release Folder using Remove-Template...
Removing Previous Dev Sysprep Template from Dev Release Folder using Remove-Template...
Publishing Prod Template (TPLT-Win2019_vP202304s) to Content Library using New-ContentLibraryItem...
Removing Previous Prod Template Release (TPLT-Win2019_vP202303s) from Content Library Remove-ContentLibraryItem...
Sending Template Publication Email...
